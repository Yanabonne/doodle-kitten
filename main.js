(()=>{"use strict";function e(t){return e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},e(t)}function t(t,o){for(var r=0;r<o.length;r++){var n=o[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(void 0,c=function(t,o){if("object"!==e(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,"string");if("object"!==e(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(n.key),"symbol"===e(c)?c:String(c)),n)}var c}function o(e,o,r){return o&&t(e.prototype,o),r&&t(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}var r,n,c,a,l,i=document.querySelector(".game"),s=document.querySelector(".game__left"),u=document.querySelector(".game__right"),f=document.createElement("div"),m=50,p=!1,d=[],v=!0,y=!1,b=!1,S=0,g=0,_=Number(getComputedStyle(i).height.replace("px","")),h=Number(getComputedStyle(i).width.replace("px","")),I=85/450*h,L=25/85*I,x=60/450*h,E=1/3*h,k=Math.floor(_/E),q=E,w=_/k,C=document.querySelector("#popup_start"),j=C.querySelector("#popup-button_start"),P=C.querySelector("#popup_link-to-rules"),A=document.querySelector("#popup_game-over"),M=A.querySelector("#popup-button_game-over"),N=document.querySelector("#popup_rules"),O=N.querySelector(".popup__link"),T=o((function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.bottom=t,this.left=Math.random()*(h-I),this.visual=document.createElement("div");var o=this.visual;o.classList.add("game__platform"),o.style.left="".concat(this.left,"px"),o.style.bottom="".concat(this.bottom,"px"),i.appendChild(o)}));function R(e){e.classList.add("popup_inactive")}function z(e){e.classList.remove("popup_inactive")}function B(){q>1/3*_&&d.forEach((function(e){if(e.bottom-=4,e.visual.style.bottom="".concat(e.bottom,"px"),e.bottom<1/60*_){d[0].visual.classList.remove("game__platform"),d.shift(),S+=1;var t=new T(_);d.push(t)}}))}function D(){clearInterval(n),v=!0,r=setInterval((function(){q+=1/30*_,f.style.bottom="".concat(q,"px"),q>E+1/3*_&&(clearInterval(r),v=!1,n=setInterval((function(){q-=1/120*_,f.style.bottom="".concat(q,"px"),q<=0&&function(){for(p=!0,s.classList.add("game__disabled"),u.classList.add("game__disabled");i.firstChild;)i.removeChild(i.firstChild);clearInterval(r),clearInterval(n),clearInterval(a),clearInterval(c),clearInterval(l),localStorage.getItem("bestSavedScore")?S>localStorage.getItem("bestSavedScore")?(localStorage.setItem("bestSavedScore",S),g=S):g=localStorage.getItem("bestSavedScore"):S>g&&(localStorage.setItem("bestSavedScore",S),g=S),A.querySelector("#score").textContent="Ваш счёт: ".concat(S),A.querySelector("#best-score").textContent="Ваш лучший счёт: ".concat(g),z(A),d=[],S=0}(),d.forEach((function(e){q>=e.bottom&&q<=e.bottom+L&&m+x>=e.left&&m<=e.left+I&&!v&&(E=q,D())}))}),30))}),30)}function F(){if(b)clearInterval(c),b=!1;else{if(y)return;y=!0,a=setInterval((function(){m>=0?(m-=5,f.style.left="".concat(m,"px")):(y=!1,clearInterval(a))}),30)}}function G(){if(y)clearInterval(a),y=!1;else{if(b)return;b=!0,c=setInterval((function(){m<=h-x?(m+=5,f.style.left="".concat(m,"px")):(b=!1,clearInterval(c))}),30)}}function H(e){"ArrowLeft"===e.key?F():"ArrowRight"===e.key&&G()}j.addEventListener("click",(function(){p||(s.classList.remove("game__disabled"),u.classList.remove("game__disabled"),R(C),function(){for(var e=0;e<k;e++){var t=new T(1/6*_+e*w);d.push(t)}}(),i.appendChild(f),f.classList.add("game__doodler"),m=d[0].left,f.style.left="".concat(m,"px"),f.style.bottom="".concat(q,"px"),l=setInterval(B,30),D(),document.addEventListener("keyup",H))})),M.addEventListener("click",(function(){R(A),z(C),p=!1})),s.addEventListener("click",(function(){F()})),u.addEventListener("click",(function(){G()})),P.addEventListener("click",(function(){R(C),z(N)})),O.addEventListener("click",(function(){R(N),z(C)}))})();