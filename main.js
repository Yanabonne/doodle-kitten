(()=>{"use strict";function e(t){return e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},e(t)}function t(t,o){for(var r=0;r<o.length;r++){var n=o[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(void 0,c=function(t,o){if("object"!==e(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,"string");if("object"!==e(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(n.key),"symbol"===e(c)?c:String(c)),n)}var c}function o(e,o,r){return o&&t(e.prototype,o),r&&t(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}var r,n,c,l,a,i=document.querySelector(".game"),u=document.querySelector(".controller__left"),s=document.querySelector(".controller__right"),f=document.createElement("div"),p=50,v=!1,m=[],d=!0,y=!1,b=!1,S=0,h=0,g=Number(getComputedStyle(i).height.replace("px","")),I=Number(getComputedStyle(i).width.replace("px","")),_=85/450*I,E=25/85*_,L=60/450*I,k=1/3*I,x=Math.floor(g/k),q=k,w=g/x,C=document.querySelector("#popup_start"),j=C.querySelector("#popup-button_start"),P=C.querySelector("#popup_link-to-rules"),A=document.querySelector("#popup_game-over"),M=A.querySelector("#popup-button_game-over"),N=document.querySelector("#popup_rules"),O=N.querySelector(".popup__link"),T=o((function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.bottom=t,this.left=Math.random()*(I-_),this.visual=document.createElement("div");var o=this.visual;o.classList.add("game__platform"),o.style.left="".concat(this.left,"px"),o.style.bottom="".concat(this.bottom,"px"),i.appendChild(o)}));function R(e){e.classList.add("popup_inactive")}function z(e){e.classList.remove("popup_inactive")}function B(){q>1/3*g&&m.forEach((function(e){if(e.bottom-=4,e.visual.style.bottom="".concat(e.bottom,"px"),e.bottom<1/60*g){m[0].visual.classList.remove("game__platform"),m.shift(),S+=1;var t=new T(g);m.push(t)}}))}function D(){clearInterval(n),d=!0,r=setInterval((function(){q+=1/30*g,f.style.bottom="".concat(q,"px"),q>k+1/3*g&&(clearInterval(r),d=!1,n=setInterval((function(){q-=1/120*g,f.style.bottom="".concat(q,"px"),q<=0&&function(){for(v=!0;i.firstChild;)i.removeChild(i.firstChild);clearInterval(r),clearInterval(n),clearInterval(l),clearInterval(c),clearInterval(a),localStorage.getItem("bestSavedScore")?S>localStorage.getItem("bestSavedScore")?(localStorage.setItem("bestSavedScore",S),h=S):h=localStorage.getItem("bestSavedScore"):S>h&&(localStorage.setItem("bestSavedScore",S),h=S),A.querySelector("#score").textContent="Ваш счёт: ".concat(S),A.querySelector("#best-score").textContent="Ваш лучший счёт: ".concat(h),z(A),b=!1,y=!1,m=[],S=0,u.removeEventListener("click",F),s.removeEventListener("click",G)}(),m.forEach((function(e){q>=e.bottom&&q<=e.bottom+E&&p+L>=e.left&&p<=e.left+_&&!d&&(k=q,D())}))}),30))}),30)}function F(){if(b)clearInterval(c),b=!1;else{if(y)return;y=!0,l=setInterval((function(){p>=0?(p-=5,f.style.left="".concat(p,"px")):(y=!1,clearInterval(l))}),30)}}function G(){if(y)clearInterval(l),y=!1;else{if(b)return;b=!0,c=setInterval((function(){p<=I-L?(p+=5,f.style.left="".concat(p,"px")):(b=!1,clearInterval(c))}),30)}}function H(e){"ArrowLeft"===e.key?F():"ArrowRight"===e.key&&G()}j.addEventListener("click",(function(){v||(u.addEventListener("click",F),s.addEventListener("click",G),R(C),function(){for(var e=0;e<x;e++){var t=new T(1/6*g+e*w);m.push(t)}}(),i.appendChild(f),f.classList.add("game__doodler"),p=m[0].left,f.style.left="".concat(p,"px"),f.style.bottom="".concat(q,"px"),a=setInterval(B,30),D(),document.addEventListener("keyup",H))})),M.addEventListener("click",(function(){R(A),z(C),v=!1})),P.addEventListener("click",(function(){R(C),z(N)})),O.addEventListener("click",(function(){R(N),z(C)}))})();